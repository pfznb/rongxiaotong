{"remainingRequest":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/vue-loader@15.11.1/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/panfangziniubi/Desktop/project/sale/src/views/HomeCollect.vue?vue&type=style&index=0&id=307bd4fe&lang=less&scoped=true","dependencies":[{"path":"/Users/panfangziniubi/Desktop/project/sale/src/views/HomeCollect.vue","mtime":1690101942000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/css-loader@3.6.0/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/vue-loader@15.11.1/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/less-loader@5.0.0/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/cache-loader@4.1.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/vue-loader@15.11.1/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKLnBsYWNlLW9yZGVyewogIGZsb2F0OiByaWdodDsKCn0KCgoKLmZhdm9yaXRlcyB7CiAgd2lkdGg6IDExMDBweDsKICBtYXJnaW46IDEwcHggYXV0bzsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIHBhZGRpbmc6IDEwcHggMjBweDsKICAuZ29vZHMgewogICAgd2lkdGg6IDUwMHB4OwogICAgaW1nIHsKICAgICAgZmxvYXQ6IGxlZnQ7CiAgICAgIHdpZHRoOiAxNTBweDsKICAgICAgaGVpZ2h0OiAxMDBweDsKICAgICAgbWFyZ2luLXJpZ2h0OiAxMHB4OwogICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICB9CiAgICAuaW5mbyB7CiAgICAgIC8vIGZsb2F0OiBsZWZ0OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7CiAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OwogICAgICAudGl0bGUgewogICAgICAgIG1hcmdpbjogMDsKICAgICAgfQogICAgICAuY29udGVudCB7CiAgICAgICAgaGVpZ2h0OiA2NXB4OwogICAgICAgIC8vIHdpZHRoOiAyMDBweDsKICAgICAgICAvKui2heWHuueahOmDqOWIhumakOiXjyovCiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAvKuaWh+Wtl+eUqOecgeeVpeWPt+abv+S7o+i2heWHuueahOmDqOWIhiovCiAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICAgICAgLyrlvLnmgKfkvLjnvKnnm5LlrZDmqKHlnovmmL7npLoqLwogICAgICAgIGRpc3BsYXk6IC13ZWJraXQtYm94OwogICAgICAgIC8q6ZmQ5Yi25Zyo5LiA5Liq5Z2X5YWD57Sg5pi+56S65paH5pys55qE6KGM5pWwKi8KICAgICAgICAtd2Via2l0LWxpbmUtY2xhbXA6IDM7CiAgICAgICAgLyrorr7nva7miJbmo4DntKLkvLjnvKnnm5Llr7nosaHnmoTlrZDlhYPntKDmjpLliJfmlrnlvI8qLwogICAgICAgIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7CiAgICAgIH0KICAgIH0KICB9CiAgCn0K"},{"version":3,"sources":["HomeCollect.vue"],"names":[],"mappings":";;;AA0NA;AACA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"HomeCollect.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"favorites\">\n\n    <el-table\n      ref=\"favoritesTable\"\n      :data=\"dataArray\"\n      stripe:true\n      tooltip-effect=\"dark\"\n      style=\"width: 100%; margin-top: 20px;\"\n      :row-key=\"(row) => { return row.id }\"\n      :row-class-name=\"rowClassName\"\n      @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" :selectable=\"selectable\" width=\"55\"></el-table-column>\n      <el-table-column label=\"商品\">\n        <template slot-scope=\"scope\">\n          <div class=\"goods\">\n            <img :src=\"$store.state.imgShowRoad + '/file/' + scope.row.picture\" alt=\"\"/>\n            <div class=\"info\">\n              <h4 class=\"title\">{{ scope.row.title }}</h4>\n              <p class=\"content\">{{ scope.row.description }}</p>\n            </div>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"单价\" width=\"120\">\n        <template slot-scope=\"scope\">\n          <p class=\"price\">{{ scope.row.price }}</p>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" show-overflow-tooltip width=\"100\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"info\" class=\"delete-btn\" @click=\"deleteClick(scope.row)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"margin-top: 20px\" class=\"cancel\">\n      <el-button @click=\"toggleSelection()\">取消选择</el-button>\n      <el-button @click=\"addShopcartClick\" type=\"danger\"  class=\"place-order\" >加入购物车</el-button>\n    </div>\n    \n    \n  </div>\n</template>\n\n<script>\nimport { showcollect, collectdelete, addOrderToCart } from \"../api/cart\";\n\nexport default {\n  data() {\n    return {\n      dataArray: [],\n      favoritesSelection: [],\n      multipleSelection: [],\n      selectedRows: [] // 保存选中的行数据\n    };\n  },\n\n  \n  methods: {\n    handleSelectionChange(rows) {\n      // 处理行点击事件，将选中的行数据保存到 selectedRows 数组中\n      rows.forEach(row => {\n        const isSelected = this.selectedRows.some(item => item === row);\n        if (isSelected) {\n          this.selectedRows = this.selectedRows.filter(item => item !== row);\n        } else {\n          this.selectedRows.push(row);\n        }\n      });\n    },\n    toggleSelection(rows) {\n      const favoritesTable = this.$refs.favoritesTable;\n      if (rows) {\n        rows.forEach(row => {\n          favoritesTable.toggleRowSelection(row);\n        });\n      } else {\n        favoritesTable.clearSelection();\n      }\n    },\n    // 加入购物车\n    addShopcartClick() {\n      const selectedRows = this.selectedRows;\n\n      if (selectedRows && selectedRows.length > 0) {\n        selectedRows.forEach(selectedProduct => {\n          addOrderToCart({\n            order_id: selectedProduct.orderId\n          })\n            .then(res => {\n              console.log(res);\n              if (res.flag === true) {\n                alert(res.message);\n              } else {\n                alert(res.message);\n              }\n            })\n            .catch(err => {\n              alert(\"添加失败，请先登录\");\n            });\n            this.deleteClick(selectedProduct);\n        });\n\n        console.log(\"选中的商品已添加到购物车\");\n        this.toggleSelection(); // 清除选中状态\n      } \n      else {\n        console.log(\"请选择商品\");\n      }\n    },\n\n\n\n    //展示收藏夹信息\n    getOrderList(){\n      showcollect({}).then((res) => {\n        if (res.flag == true) {\n          this.dataArray = res.data;\n          this.totalprice = 0;\n        } else {\n          this.$message.error('您未登录，请先登录')\n          this.$router.push(\"/login\")\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n    },\n\n    rowClassName({ row, rowIndex }) {\n      row.index = rowIndex;\n    },\n   \n    deleteClick(row) {\n      this.$confirm('确认删除该商品?', '删除', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n\n          collectdelete({\n            order_id: row.shoppingId,\n          }).then((res) => {\n            this.$message.success(\"删除成功\");\n            this.getOrderList()\n          }).catch((err) => {\n            this.$message.error(\"删除失败\");\n          });\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n    },\n    \n  },\n  created() {\n    this.getOrderList()\n  }\n};\n</script>\n  \n  <style lang=\"less\" scoped>\n\n\n  .place-order{\n    float: right;\n\n  }\n\n\n\n  .favorites {\n    width: 1100px;\n    margin: 10px auto;\n    background: #fff;\n    padding: 10px 20px;\n    .goods {\n      width: 500px;\n      img {\n        float: left;\n        width: 150px;\n        height: 100px;\n        margin-right: 10px;\n        border-radius: 6px;\n      }\n      .info {\n        // float: left;\n        display: flex;\n        flex-direction: column;\n        justify-content: flex-start;\n        align-items: flex-start;\n        .title {\n          margin: 0;\n        }\n        .content {\n          height: 65px;\n          // width: 200px;\n          /*超出的部分隐藏*/\n          overflow: hidden;\n          /*文字用省略号替代超出的部分*/\n          text-overflow: ellipsis;\n          /*弹性伸缩盒子模型显示*/\n          display: -webkit-box;\n          /*限制在一个块元素显示文本的行数*/\n          -webkit-line-clamp: 3;\n          /*设置或检索伸缩盒对象的子元素排列方式*/\n          -webkit-box-orient: vertical;\n        }\n      }\n    }\n    \n  }\n  </style>"]}]}