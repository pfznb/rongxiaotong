{"remainingRequest":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/vue-loader@15.11.1/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/panfangziniubi/Desktop/project/sale/src/views/HomeCollect.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/panfangziniubi/Desktop/project/sale/src/views/HomeCollect.vue","mtime":1690101942000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/cache-loader@4.1.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/babel-loader@8.3.0/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/cache-loader@4.1.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/panfangziniubi/Desktop/project/sale/node_modules/.store/vue-loader@15.11.1/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHNob3djb2xsZWN0LCBjb2xsZWN0ZGVsZXRlLCBhZGRPcmRlclRvQ2FydCB9IGZyb20gIi4uL2FwaS9jYXJ0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YUFycmF5OiBbXSwKICAgICAgZmF2b3JpdGVzU2VsZWN0aW9uOiBbXSwKICAgICAgbXVsdGlwbGVTZWxlY3Rpb246IFtdLAogICAgICBzZWxlY3RlZFJvd3M6IFtdIC8vIOS/neWtmOmAieS4reeahOihjOaVsOaNrgogICAgfTsKICB9LAoKICAKICBtZXRob2RzOiB7CiAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2Uocm93cykgewogICAgICAvLyDlpITnkIbooYzngrnlh7vkuovku7bvvIzlsIbpgInkuK3nmoTooYzmlbDmja7kv53lrZjliLAgc2VsZWN0ZWRSb3dzIOaVsOe7hOS4rQogICAgICByb3dzLmZvckVhY2gocm93ID0+IHsKICAgICAgICBjb25zdCBpc1NlbGVjdGVkID0gdGhpcy5zZWxlY3RlZFJvd3Muc29tZShpdGVtID0+IGl0ZW0gPT09IHJvdyk7CiAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dzID0gdGhpcy5zZWxlY3RlZFJvd3MuZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPT0gcm93KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd3MucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgdG9nZ2xlU2VsZWN0aW9uKHJvd3MpIHsKICAgICAgY29uc3QgZmF2b3JpdGVzVGFibGUgPSB0aGlzLiRyZWZzLmZhdm9yaXRlc1RhYmxlOwogICAgICBpZiAocm93cykgewogICAgICAgIHJvd3MuZm9yRWFjaChyb3cgPT4gewogICAgICAgICAgZmF2b3JpdGVzVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdyk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmF2b3JpdGVzVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgfQogICAgfSwKICAgIC8vIOWKoOWFpei0reeJqei9pgogICAgYWRkU2hvcGNhcnRDbGljaygpIHsKICAgICAgY29uc3Qgc2VsZWN0ZWRSb3dzID0gdGhpcy5zZWxlY3RlZFJvd3M7CgogICAgICBpZiAoc2VsZWN0ZWRSb3dzICYmIHNlbGVjdGVkUm93cy5sZW5ndGggPiAwKSB7CiAgICAgICAgc2VsZWN0ZWRSb3dzLmZvckVhY2goc2VsZWN0ZWRQcm9kdWN0ID0+IHsKICAgICAgICAgIGFkZE9yZGVyVG9DYXJ0KHsKICAgICAgICAgICAgb3JkZXJfaWQ6IHNlbGVjdGVkUHJvZHVjdC5vcmRlcklkCiAgICAgICAgICB9KQogICAgICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICAgICAgaWYgKHJlcy5mbGFnID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICBhbGVydChyZXMubWVzc2FnZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFsZXJ0KHJlcy5tZXNzYWdlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gewogICAgICAgICAgICAgIGFsZXJ0KCLmt7vliqDlpLHotKXvvIzor7flhYjnmbvlvZUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuZGVsZXRlQ2xpY2soc2VsZWN0ZWRQcm9kdWN0KTsKICAgICAgICB9KTsKCiAgICAgICAgY29uc29sZS5sb2coIumAieS4reeahOWVhuWTgeW3sua3u+WKoOWIsOi0reeJqei9piIpOwogICAgICAgIHRoaXMudG9nZ2xlU2VsZWN0aW9uKCk7IC8vIOa4hemZpOmAieS4reeKtuaAgQogICAgICB9IAogICAgICBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygi6K+36YCJ5oup5ZWG5ZOBIik7CiAgICAgIH0KICAgIH0sCgoKCiAgICAvL+WxleekuuaUtuiXj+WkueS/oeaBrwogICAgZ2V0T3JkZXJMaXN0KCl7CiAgICAgIHNob3djb2xsZWN0KHt9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLmZsYWcgPT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy5kYXRhQXJyYXkgPSByZXMuZGF0YTsKICAgICAgICAgIHRoaXMudG90YWxwcmljZSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aCqOacqueZu+W9le+8jOivt+WFiOeZu+W9lScpCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2xvZ2luIikKICAgICAgICB9CiAgICAgIH0pCiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfSk7CiAgICB9LAoKICAgIHJvd0NsYXNzTmFtZSh7IHJvdywgcm93SW5kZXggfSkgewogICAgICByb3cuaW5kZXggPSByb3dJbmRleDsKICAgIH0sCiAgIAogICAgZGVsZXRlQ2xpY2socm93KSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruiupOWIoOmZpOivpeWVhuWTgT8nLCAn5Yig6ZmkJywgewogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICB9KS50aGVuKCgpID0+IHsKCiAgICAgICAgICBjb2xsZWN0ZGVsZXRlKHsKICAgICAgICAgICAgb3JkZXJfaWQ6IHJvdy5zaG9wcGluZ0lkLAogICAgICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5Yig6Zmk5oiQ5YqfIik7CiAgICAgICAgICAgIHRoaXMuZ2V0T3JkZXJMaXN0KCkKICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5Yig6Zmk5aSx6LSlIik7CiAgICAgICAgICB9KTsKCiAgICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcKICAgICAgICAgIH0pOyAgICAgICAgICAKICAgICAgICB9KTsKICAgIH0sCiAgICAKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldE9yZGVyTGlzdCgpCiAgfQp9Owo="},{"version":3,"sources":["HomeCollect.vue"],"names":[],"mappings":";AA6CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"HomeCollect.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"favorites\">\n\n    <el-table\n      ref=\"favoritesTable\"\n      :data=\"dataArray\"\n      stripe:true\n      tooltip-effect=\"dark\"\n      style=\"width: 100%; margin-top: 20px;\"\n      :row-key=\"(row) => { return row.id }\"\n      :row-class-name=\"rowClassName\"\n      @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" :selectable=\"selectable\" width=\"55\"></el-table-column>\n      <el-table-column label=\"商品\">\n        <template slot-scope=\"scope\">\n          <div class=\"goods\">\n            <img :src=\"$store.state.imgShowRoad + '/file/' + scope.row.picture\" alt=\"\"/>\n            <div class=\"info\">\n              <h4 class=\"title\">{{ scope.row.title }}</h4>\n              <p class=\"content\">{{ scope.row.description }}</p>\n            </div>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"单价\" width=\"120\">\n        <template slot-scope=\"scope\">\n          <p class=\"price\">{{ scope.row.price }}</p>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" show-overflow-tooltip width=\"100\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"info\" class=\"delete-btn\" @click=\"deleteClick(scope.row)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"margin-top: 20px\" class=\"cancel\">\n      <el-button @click=\"toggleSelection()\">取消选择</el-button>\n      <el-button @click=\"addShopcartClick\" type=\"danger\"  class=\"place-order\" >加入购物车</el-button>\n    </div>\n    \n    \n  </div>\n</template>\n\n<script>\nimport { showcollect, collectdelete, addOrderToCart } from \"../api/cart\";\n\nexport default {\n  data() {\n    return {\n      dataArray: [],\n      favoritesSelection: [],\n      multipleSelection: [],\n      selectedRows: [] // 保存选中的行数据\n    };\n  },\n\n  \n  methods: {\n    handleSelectionChange(rows) {\n      // 处理行点击事件，将选中的行数据保存到 selectedRows 数组中\n      rows.forEach(row => {\n        const isSelected = this.selectedRows.some(item => item === row);\n        if (isSelected) {\n          this.selectedRows = this.selectedRows.filter(item => item !== row);\n        } else {\n          this.selectedRows.push(row);\n        }\n      });\n    },\n    toggleSelection(rows) {\n      const favoritesTable = this.$refs.favoritesTable;\n      if (rows) {\n        rows.forEach(row => {\n          favoritesTable.toggleRowSelection(row);\n        });\n      } else {\n        favoritesTable.clearSelection();\n      }\n    },\n    // 加入购物车\n    addShopcartClick() {\n      const selectedRows = this.selectedRows;\n\n      if (selectedRows && selectedRows.length > 0) {\n        selectedRows.forEach(selectedProduct => {\n          addOrderToCart({\n            order_id: selectedProduct.orderId\n          })\n            .then(res => {\n              console.log(res);\n              if (res.flag === true) {\n                alert(res.message);\n              } else {\n                alert(res.message);\n              }\n            })\n            .catch(err => {\n              alert(\"添加失败，请先登录\");\n            });\n            this.deleteClick(selectedProduct);\n        });\n\n        console.log(\"选中的商品已添加到购物车\");\n        this.toggleSelection(); // 清除选中状态\n      } \n      else {\n        console.log(\"请选择商品\");\n      }\n    },\n\n\n\n    //展示收藏夹信息\n    getOrderList(){\n      showcollect({}).then((res) => {\n        if (res.flag == true) {\n          this.dataArray = res.data;\n          this.totalprice = 0;\n        } else {\n          this.$message.error('您未登录，请先登录')\n          this.$router.push(\"/login\")\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n    },\n\n    rowClassName({ row, rowIndex }) {\n      row.index = rowIndex;\n    },\n   \n    deleteClick(row) {\n      this.$confirm('确认删除该商品?', '删除', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n\n          collectdelete({\n            order_id: row.shoppingId,\n          }).then((res) => {\n            this.$message.success(\"删除成功\");\n            this.getOrderList()\n          }).catch((err) => {\n            this.$message.error(\"删除失败\");\n          });\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n    },\n    \n  },\n  created() {\n    this.getOrderList()\n  }\n};\n</script>\n  \n  <style lang=\"less\" scoped>\n\n\n  .place-order{\n    float: right;\n\n  }\n\n\n\n  .favorites {\n    width: 1100px;\n    margin: 10px auto;\n    background: #fff;\n    padding: 10px 20px;\n    .goods {\n      width: 500px;\n      img {\n        float: left;\n        width: 150px;\n        height: 100px;\n        margin-right: 10px;\n        border-radius: 6px;\n      }\n      .info {\n        // float: left;\n        display: flex;\n        flex-direction: column;\n        justify-content: flex-start;\n        align-items: flex-start;\n        .title {\n          margin: 0;\n        }\n        .content {\n          height: 65px;\n          // width: 200px;\n          /*超出的部分隐藏*/\n          overflow: hidden;\n          /*文字用省略号替代超出的部分*/\n          text-overflow: ellipsis;\n          /*弹性伸缩盒子模型显示*/\n          display: -webkit-box;\n          /*限制在一个块元素显示文本的行数*/\n          -webkit-line-clamp: 3;\n          /*设置或检索伸缩盒对象的子元素排列方式*/\n          -webkit-box-orient: vertical;\n        }\n      }\n    }\n    \n  }\n  </style>"]}]}